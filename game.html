<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <style>
        html, body {
            margin: 0;
            padding: 0;

            width: 100%;
            height: 100%;

            overflow: hidden;
        }
    </style>
</head>
<body>
    <script src='jquery.min.js'></script>
    <script src='cannon.min.js'></script>
    <script src='three.min.js'></script>
    <script src='game.physics.js'></script>
    <script src='game.scene.js'></script>
    <script src='game.mode.js'></script>
    <script>
        'use strict';

        var world = new GameWorld(function () {
            var shape = new CANNON.Sphere(1);
            var body = new CANNON.Body({mass: 1}); // mass

            body.addShape(shape);
            this.addBody(body);
            this.testBody = body;
        }, function () {
            //
        });

        var scene = new GameScene('body', function (handler) {
            $(window).resize(handler);
        }, testGameMode, function () {
            var geometry = new THREE.SphereGeometry(1, 16, 16);
            var material = new THREE.MeshLambertMaterial({
                color: 0x808080,
                map: THREE.ImageUtils.loadTexture('background.jpg'),
            });
            var object = new THREE.Mesh(geometry, material);

            this.add(object);
            this.testObject = object;

            ///

            var spotLight = new THREE.SpotLight(0xffffff);
            spotLight.position.set(0, -195, 5);

            // spotLight.castShadow = true;

            // spotLight.shadowMapWidth = 1024;
            // spotLight.shadowMapHeight = 1024;

            // spotLight.shadowCameraNear = 500;
            // spotLight.shadowCameraFar = 4000;
            // spotLight.shadowCameraFov = 30;

            this.add(spotLight);

            ///

            this.camera.position.set(0, -190, 5);
            // this.camera.position.set(0, 0, 5);
        }, function () {
            world.simulate();

            var delta = 0.001 * (world.timeNow - world.timeSim);

            this.testObject.position.copy(world.testBody.predictPosition(delta));
            this.testObject.rotation.setFromVector3(world.testBody.predictRotation(delta), 'YZX');
        });
    </script>
</body>
</html>
